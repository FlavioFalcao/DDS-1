<?xml version="1.0" encoding="UTF-8"?>
<!--
    $Id$
-->
<project name="common"
         xmlns:ivy="antlib:org.apache.ivy.ant"
         xmlns:opendds="antlib:org.opendds.ant">

    <dirname property="project.basedir" file="${ant.file.common}/.."/>

    <property file="${project.basedir}/build.properties"/>

    <property environment="env"/>

    <!-- Project properties -->
    <property name="project.common.dir" value="${project.basedir}/common"/>
    <property name="project.common.lib.dir" value="${project.common.dir}/lib"/>
    <property name="project.plugins.dir" value="${project.basedir}/plugins"/>

    <!-- Plugin properties -->
    <property name="eclipse.home" value="${env.ECLIPSE_HOME}"/>
    <property name="eclipse.plugins.dir" value="${eclipse.home}/plugins"/>

    <property name="install.dir" value="${eclipse.plugins.dir}"/>

    <!--
        Common Targets
    -->
    <target name="bootstrap" unless="common.bootstrapped">
        <property name="ivy.settings.file"
                  value="${project.common.dir}/ivysettings.xml"/>

        <!-- Apache Ivy initialization -->
        <taskdef uri="antlib:org.apache.ivy.ant"
                 resource="org/apache/ivy/ant/antlib.xml"
                 classpath="${project.common.lib.dir}/ivy-2.1.0.jar"/>

        <ivy:configure/>

        <!-- Prevent spurious re-initialization -->
        <property name="common.bootstrapped" value="true"/>
    </target>

    <target name="resolve" depends="bootstrap" unless="common.resolved">
        <ivy:resolve/>

        <ivy:cachepath pathid="cache.classpath"/>

        <path id="common.classpath">
            <path refid="cache.classpath"/>
            <fileset dir="${project.common.lib.dir}">
                <include name="*.jar"/>
            </fileset>
        </path>

        <!-- OpenDDS initialization -->
        <taskdef uri="antlib:org.opendds.ant"
                 resource="org/opendds/ant/antlib.xml"
                 classpathref="common.classpath"/>

        <opendds:init environment="env"/>

        <!-- Prevent spurious re-initialization -->
        <property name="common.resolved" value="true"/>
    </target>

    <!-- Dummy targets -->
    <target name="clean"/>
    <target name="test"/>
    <target name="install"/>
</project>
