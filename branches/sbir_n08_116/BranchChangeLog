Thu Apr 15 22:02:07 UTC 2010  Adam Mitz  <mitza@ociweb.com>

        The Content-Subscription Profile requires some support from the code
        generator for runtime binding to the user-defined structures.  This
        commit starts to implement that generated code.  Eventually the new
        code generator will generate all code for OpenDDs, including the code
        that's currently generated by tao_idl -Gdcps and by dcps_ts.pl.

        * dds/idl:
        * dds/idl/be_extern.h:
        * dds/idl/be_global.h:
        * dds/idl/be_global.cpp:
        * dds/idl/be_init.cpp:
        * dds/idl/be_produce.cpp:
        * dds/idl/dds_generator.h:
        * dds/idl/dds_generator.cpp:
        * dds/idl/dds_visitor.h:
        * dds/idl/dds_visitor.cpp:
        * dds/idl/drv_args.cpp:
        * dds/idl/drv_preproc.cpp:
        * dds/idl/metaclass_generator.h:
        * dds/idl/metaclass_generator.cpp:
        * dds/idl/opendds_idl.cpp:
        * dds/idl/opendds_idl.mpc:

          New code generator that uses the TAO_IDL front-end.  As of now this
          only generates support for the filter strings used by QueryCondition
          and by (the soon to be implemented) ContentFilteredTopic.

        * dds/DdsDcps.mpc:
        * dds/dcps_bits.mpb:

          Invoke the new code generator on DdsDcpsInfrastructure.idl

        * dds/DCPS/FilterEvaluator.h:
        * dds/DCPS/FilterEvaluator.cpp:

          #if 0'ed some temporary code which is now handled by the new code
          generator.

        * bin/dcps_ts.pl:

          Added a -z switch which #includes the new generated header in the
          generated TypeSupportImpl.cpp

        * tests/DCPS/FilterExpression/FilterExpression.cpp:

          #include the new generated header and added try/catch.

Tue Apr 13 21:58:14 UTC 2010  Adam Mitz  <mitza@ociweb.com>

        * dds/DCPS/DataCollector_T.cpp:

          Fixed 64-bit warnings that show up when compiling DataReaderImpl.

        * dds/DCPS/DataReaderImpl.cpp:

          Fixed 64-bit warnings and improved error handling in
          create_querycondition().

        * dds/DCPS/FilterEvaluator.h:
        * dds/DCPS/FilterEvaluator.cpp:

          Added support for unsigned int (CORBA::ULong) types in the filter
          structs.  Also improved the support for conversion between data
          types.  Improved error handling in the case where the parse fails.
          Fixed logic for short-circuiting ANDs and ORs.  Refactored
          implementation of Value to use a Boost.Variant-like visitor instead
          of switch statements.

        * tests/DCPS/FilterExpression/FilterExpression.cpp:

          Added tests that actually evaluate filter expressions using the
          struct TopicBuiltinTopicData.

        * tests/DCPS/QueryCondition/QueryConditionTest.cpp:

          Removed some extraneous namespace scoping in preparation for
          enhancing this test once we have the code generation support.

Mon Apr 12 14:24:38 UTC 2010  Adam Mitz  <mitza@ociweb.com>

        * dds/DCPS/FilterEvaluator.h:
        * dds/DCPS/FilterEvaluator.cpp:

          Implemented filter evaluation (first pass).  It still needs to handle
          more data types, and it depends on some help from a code generation
          tool (TAO_IDL or something else), which is not done yet.  For now
          the support for the TopicBuiltinTopicData struct is implemented here
          for testing.

        * bin/dcps_tests.lst:
        * tests/DCPS/FilterExpression/FilterExpression.cpp:
        * tests/DCPS/FilterExpression/FilterExpressionTest.mpc:
        * tests/DCPS/FilterExpression/run_test.pl:

          Added a test for parsing filter (and query) expressions.  Right now
          this test only checks the syntax of the expressions.

Fri Apr  9 18:11:38 UTC 2010  Yan Dai  <dai_y@ociweb.com>

        * bin/DCPS/CPPTemplate.pm:
        * bin/DCPS/HTemplate.pm:
        * dds/DCPS/BitPubListenerImpl.h:
        * dds/DCPS/BitPubListenerImpl.cpp:
        * dds/DCPS/DataReaderImpl.h:
        * dds/DCPS/DataReaderImpl.cpp:
        * dds/DCPS/DataWriterImpl.h:
        * dds/DCPS/DataWriterImpl.cpp:
        * dds/DCPS/DomainParticipantImpl.h:
        * dds/DCPS/DomainParticipantImpl.cpp:
        * dds/DCPS/InstanceState.h:
        * dds/DCPS/InstanceState.cpp:
        * dds/DCPS/OwnershipManager.h:
        * dds/DCPS/OwnershipManager.cpp:
        * dds/DCPS/Qos_Helper.inl:
        * dds/DCPS/RequestedDeadlineWatchdog.cpp:
        * dds/DCPS/SubscriberImpl.h:
        * dds/DCPS/SubscriberImpl.cpp:
        * dds/DCPS/TopicImpl.h:
        * dds/DCPS/TopicImpl.cpp:
        * dds/DCPS/OwnershipManager.h:
        * dds/DCPS/OwnershipManager.cpp:
        * dds/InfoRepo/DCPS_Utils.cpp:

          Added support for the ownership qos.

        * tests/DCPS/Ownership/DataReaderListener.h:
        * tests/DCPS/Ownership/DataReaderListener.cpp:
        * tests/DCPS/Ownership/Messenger.idl:
        * tests/DCPS/Ownership/Ownership.mpc:
        * tests/DCPS/Ownership/Writer.h:
        * tests/DCPS/Ownership/Writer.cpp:
        * tests/DCPS/Ownership/pub.ini:
        * tests/DCPS/Ownership/publisher.cpp:
        * tests/DCPS/Ownership/run_test.pl:
        * tests/DCPS/Ownership/sub.ini:
        * tests/DCPS/Ownership/subscriber.cpp:
        * tests/DCPS/Ownership/tcp.conf:

          New test.

        * tests/DCPS/unit/MyTypeSupportImpl.h:

          Accommodated the changes.

        * bin/dcps_tests.lst:

          Added Ownership test cases.

Wed Apr  7 15:32:56 UTC 2010  Adam Mitz  <mitza@ociweb.com>

        The following is for the Content-Subscription Profile implementation

        * dds/DCPS/FilterEvaluator.h:
        * dds/DCPS/FilterEvaluator.cpp:
        * dds/DCPS/FilterExpressionGrammar.h:

          Added a new class for evaluating filter (and query) expressions.
          This is an early version that parses the expression but doesn't do
          much evaluation, except as needed to support the current OpenDDS
          feature of "ORDER BY" sorting in QueryCondition.

        * dds/DCPS/DataReaderImpl.cpp:
        * dds/DCPS/QueryConditionImpl.h:
        * dds/DCPS/QueryConditionImpl.cpp:
        * dds/DCPS/RakeResults_T.h:
        * dds/DCPS/RakeResults_T.cpp:

          Made use of the new FilterEvaluator for QueryCondition.

        * dds/DCPS/ZeroCopySeq_T.inl:

          Fixed 64-bit warnings (when size_t is 64 bits).  Also in
          RakeResults_T.cpp.

        * dds/DdsDcps.mpc:
        * dds/DCPS/yard/*:

          yard (Yet Another Recursive Descent) is a 3rd-party library for
          constructing parsers at compile time using template metaprogramming.
          The license is either Public Domain (if applicable) or MIT, so we
          are including it here.  It's a header-only library.

Wed Mar 24 15:43:43 UTC 2010  Mike Martinez  <martinez_m@ociweb.com>

        Merging trunk changes 3113:3165 out to branch.

        Tue Mar 23 19:32:21 UTC 2010  Trevor Fields  <fields_t@ociweb.com>

                * OpenDDS version 2.1.2 released.

        Tue Mar 23 15:57:27 UTC 2010  Steven Stallion  <stallions@ociweb.com>

                * NEWS:

                  Updated documentation for next release.

        Tue Mar 23 15:45:06 UTC 2010  Steven Stallion  <stallions@ociweb.com>

                * NEWS:
                * README:

                  Updated documentation for next release.

        Mon Mar 22 21:54:24 UTC 2010  Yan Dai  <dai_y@ociweb.com>

                * NEWS:

                  Added changes for next release.

        Mon Mar 22 19:53:59 UTC 2010  Yan Dai  <dai_y@ociweb.com>

                * dds/DCPS/DataWriterImpl.h:
                * dds/DCPS/DataWriterImpl.cpp:
                * dds/DCPS/transport/framework/DataLink.h:
                * dds/DCPS/transport/framework/DataLink.inl:
                * dds/DCPS/transport/framework/DataLinkSet.h:
                * dds/DCPS/transport/framework/DataLinkSet.inl:
                * dds/DCPS/transport/framework/TransportInterface.h:
                * dds/DCPS/transport/framework/TransportInterface.inl:
                * dds/DCPS/transport/framework/TransportSendStrategy.h:
                * dds/DCPS/transport/framework/TransportSendStrategy.cpp:

                  Renamed remove_all_control_msgs() to remove_all_msgs() as the function
                  was changed to removes all messages sent by a datawriter.

                * dds/DCPS/WriteDataContainer.cpp:

                  Removed remove_sample call on samples in sending_data or released_data
                  lists as it's redundant with remove_all_msgs().

        Fri Mar 19 22:25:14 UTC 2010  Mike Martinez  <martinez_m@ociweb.com>

                * performance-tests/Bench/bin/expandColors.pl:
                * performance-tests/Bench/bin/extract.pl:
                * performance-tests/Bench/bin/genstats.pl:
                * performance-tests/Bench/bin/mktable.pl:
                * performance-tests/Bench/bin/reduce.pl:
                * performance-tests/Bench/bin/run_test:
                * performance-tests/Bench/doc/userguide.html:
                * performance-tests/Bench/tests/thru/test-commands.txt:

                  Updating documentation in scripts and user guide.

        Fri Mar 19 21:23:54 UTC 2010  Yan Dai  <dai_y@ociweb.com>

                * dds/DCPS/WriteDataContainer.cpp:

                  - Added lock in data_dropped as it could be called by the
                    the transport thread that does not hold the lock before
                    calling it. Otherwise, it may cause SEGV when write()
                    thraad request transport removing a sample while sample
                    is released due to tranport delayed notification.
                  - Added code to remove released_data_ samples in
                    unregister_all().

                * dds/DCPS/transport/framework/DataLink.h:
                * dds/DCPS/transport/framework/DataLink.inl:
                * dds/DCPS/transport/framework/DataLink.cpp:
                * dds/DCPS/transport/framework/DataLinkSet.inl:
                * dds/DCPS/transport/framework/PacketRemoveVisitor.h:
                * dds/DCPS/transport/framework/PacketRemoveVisitor.cpp:
                * dds/DCPS/transport/framework/QueueRemoveVisitor.h:
                * dds/DCPS/transport/framework/QueueRemoveVisitor.inl:
                * dds/DCPS/transport/framework/QueueRemoveVisitor.cpp:
                * dds/DCPS/transport/framework/ThreadPerConnectionSendTask.h:
                * dds/DCPS/transport/framework/ThreadPerConnectionSendTask.cpp:
                * dds/DCPS/transport/framework/TransportQueueElement.h:
                * dds/DCPS/transport/framework/TransportQueueElement.inl:
                * dds/DCPS/transport/framework/TransportSendElement.h:
                * dds/DCPS/transport/framework/TransportSendElement.cpp:
                * dds/DCPS/transport/framework/TransportSendStrategy.h:
                * dds/DCPS/transport/framework/TransportSendStrategy.inl:
                * dds/DCPS/transport/framework/TransportSendStrategy.cpp:

                  - Fixed an issue that DataWriter request transport to remove
                    a sample while the sample is released by transport.
                    This could happen when there are more number of datalinks
                    upon sample removing than sending. A datalink is requested
                    to remove sample is not requested for sending. The sample
                    may already be released while the link uses the sample to
                    find in it's storage.

                    Wrappered sample to remove with TransportSendElement so the
                    DataWriter data_dropped() will be called only when sample is
                    removed from all links it originally sent to.
                    The TransportSendElement instance also carry the information
                    if a data_dropped is called to DataWriter, if it does, then
                    stop using the sample to remove from the rest links because
                    the sample may already be released.

                  - Added/update methods to accommodate the changes above.
                  - Added transport_shutdown to TransportSendStrategy to avoid
                    delayed notification upon transport release as the transport
                    release is normally called after DataWriter is destroyed.

                * dds/DCPS/transport/simpleTCP/SimpleTcpConnection.cpp:

                  Added receive_strategy_ nil value check in handle_close()
                  to avoid crash if receive_strategy_ is wiped before
                  handle_close() called.

        Tue Mar 16 21:01:14 UTC 2010  Steven Stallion  <stallions@ociweb.com>

                * dds/DCPS/transport/multicast/ReliableSession.h:
                * dds/DCPS/transport/multicast/ReliableSession.cpp:

                  Fixed deadlock caused by shared mutex between starting and
                  acknowledgement critical sections.

        Tue Mar 16 14:18:51 UTC 2010  Mike Martinez  <martinez_m@ociweb.com>

                * performance-tests/Bench/tests/latency/p1-16000.ini:

                  Update to use new datamodel.  Thanks to Don Busch for finding
                  this.

        Thu Mar 11 23:54:38 UTC 2010  Yan Dai  <dai_y@ociweb.com>

                * dds/DCPS/WriteDataContainer.cpp:

                  Fixed a bug in obtain_buffer() when max_blocking_time is 0 or very small
                  period. The condition makes the write() not wait for old sample releasing.
                  In this case, the TIMEOUT error code should be returned.

                * dds/DCPS/DataWriterImpl.cpp:

                  Turned off the error logging as obtain_buffer() returns TIMEOUT error code.

                * tests/DCPS/FooTest5/InstanceDataMap.cpp:
                * tests/DCPS/FooTest5/Writer.cpp:
                * tests/DCPS/FooTest5/run_test.pl:

                  - Adjusted result verify.
                  - Log timeout error return from write() only if DCPS_debug_level > 0.

        Wed Mar 10 16:25:55 UTC 2010  Steven Stallion  <stallions@ociweb.com>

                * dds/DCPS/transport/framework/ThreadSynchStrategy.h:
                * dds/DCPS/transport/framework/ThreadSynchStrategy_rch.h:
                * dds/DCPS/transport/framework/TransportConfiguration.h:
                * dds/DCPS/transport/framework/TransportConfiguration.inl:
                * dds/DCPS/transport/framework/TransportConfiguration.cpp:

                  Added support for optionally specifying a ThreadSynchStrategy
                  implementation at construction-time (submitted by Don Busch).

                * dds/DCPS/transport/udp/UdpConfiguration.cpp:
                * dds/DCPS/transport/multicast/MulticastConfiguration.cpp:

                  Updated UDP-based transports to use a NullSynchStrategy by
                  default; this prevents spurious threads from being spawned
                  for each created DataLink (submitted by Don Busch).

                * dds/DCPS/transport/udp/UdpTransport.h:
                * dds/DCPS/transport/udp/UdpTransport.cpp:

                  Updated support for endpoint addressing; DataLinks are created
                  per unique endpoint rather than RepoId (submitted by Don Busch).

        Tue Mar  9 19:08:05 UTC 2010  Steven Stallion  <stallions@ociweb.com>

                * NEWS:
                * README:

                  Updated documentation for next release.

Wed Mar 10 03:59:39 UTC 2010  Mike Martinez  <martinez_m@ociweb.com>

        * BranchChangeLog:

          Added branch specific change log.
          Branch was from trunk@3112


# vim: filetype=changelog
Local Variables:
mode: change-log
add-log-time-format: (lambda () (progn (setq tz (getenv "TZ")) (set-time-zone-rule "UTC") (setq time (format-time-string "%a %b %e %H:%M:%S %Z %Y" (current-time))) (set-time-zone-rule tz) time))
indent-tabs-mode: nil
End:
